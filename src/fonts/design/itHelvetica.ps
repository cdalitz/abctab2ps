%!PS-Adobe-3.0 Resource-Font
%-----------------------------------------------
%
% Font for italian tablature in abctab2ps
% simply uses Helvetica letters
% Copyright (c) 1999 Christoph Dalitz
%

% Help functions for drawing letters with a pen
%
% lower end of pen, must be set before call to penfunctions
/penend 2 array def

% parameters in the following functions refer to upper end of pen

/penlineto { % usage like lineto
  currentpoint 4 2 roll % save startpoint
  lineto
  currentpoint 4 2 roll % save targetpoint
  penend 0 get penend 1 get rlineto
  % compute parameters for parallel line
  2 1 roll penend 0 get add
  2 1 roll penend 1 get add
  lineto
  penend 0 get neg penend 1 get neg rlineto
  eofill moveto % fill and move to targetpoint
} bind def

/penrlineto { % usage like rlineto
  2 copy   % save arguments
  rlineto
  currentpoint 4 2 roll % save targetpoint
  penend 0 get penend 1 get rlineto
  % compute parameters for parallel line
  2 1 roll neg
  2 1 roll neg
  rlineto
  penend 0 get neg penend 1 get neg rlineto
  eofill moveto % fill and move to targetpoint
} bind def

/pencurveto { % usage like curveto
  6 copy currentpoint 8 2 roll   % save position and arguments
  curveto
  currentpoint 10 2 roll % save targetpoint
  penend 0 get penend 1 get rlineto
  % compute parameters for parallel line
  4 2 roll pop pop 4 2 roll 6 2 roll
  3 {
    6 5 roll penend 0 get add
    6 5 roll penend 1 get add
  } repeat
  curveto
  penend 0 get neg penend 1 get neg rlineto
  eofill moveto % fill and move to targetpoint
} bind def

/penrcurveto { % usage like rcurveto
  6 copy   % save arguments
  rcurveto
  currentpoint 8 2 roll % save targetpoint
  penend 0 get penend 1 get rlineto
  % compute parameters for parallel line
  neg exch neg exch 
  6 2 roll exch 5 index add exch 4 index add
  4 2 roll exch 5 index add exch 4 index add
  6 -2 roll
  rcurveto
  penend 0 get neg penend 1 get neg rlineto
  fill moveto % fill and move to targetpoint
} bind def

%
% here starts the font definition
%
%%BeginResource: font ItalianTabfont
/itabfont 10 dict def
itabfont begin

/FontType 3 def

% chars are defined in 20x20 System
/FontBBox [0 0 20 20] def
/FontMatrix [0.05 0 0 0.05 0 0 ] def

% pen definitions for different font types
/frenchpen [ -2 -2 ] def   % letters in frenchtab

% connect ASCII code to drawing procedures
/Encoding 256 array def
0 1 255 { Encoding exch /.notdef put } for
Encoding
% frenchtab: a-o
dup  97 /french_a put
dup  98 /french_b put
dup  99 /french_c put
dup 100 /french_d put
dup 101 /french_e put
dup 102 /french_f put
dup 103 /french_g put
dup 104 /french_h put
dup 105 /french_i put
dup 107 /french_k put
dup 108 /french_l put
dup 109 /french_m put
dup 110 /french_n put
dup 111 /french_o put
% french bourdons: D-G
dup  68 /bourdon_4 put  % D
dup  69 /bourdon_5 put  % E
dup  70 /bourdon_6 put  % F
dup  71 /bourdon_7 put  % G
% italian bourdons: H-N
dup  72 /bourdon_8  put % H
dup  73 /bourdon_9  put % I
dup  74 /bourdon_10 put % J
dup  75 /bourdon_11 put % K
dup  76 /bourdon_12 put % L
dup  77 /bourdon_13 put % M
dup  78 /bourdon_14 put % N

116 /test_t put

% drawing procedures
/drawchar 4 dict def
drawchar begin
  /.notdef {} def

  % french letters
  /french_a {
        /Helvetica 20 selectfont
        5 3 moveto (0) show
  } def
  /french_b {
        /Helvetica 20 selectfont
        5 3 moveto (1) show
  } def
  /french_c {
        /Helvetica 20 selectfont
        5 3 moveto (2) show
  } def
  /french_d {
        /Helvetica 20 selectfont
        5 3 moveto (3) show
  } def
  /french_e {
        /Helvetica 20 selectfont
        5 3 moveto (4) show
  } def
  /french_f {
        /Helvetica 20 selectfont
        5 3 moveto (5) show
  } def
  /french_g {
        /Helvetica 20 selectfont
        5 3 moveto (6) show
  } def
  /french_h {
        /Helvetica 20 selectfont
        5 3 moveto (7) show
  } def
  /french_i {
        /Helvetica 20 selectfont
        5 3 moveto (8) show
  } def
  /french_k {
        /Helvetica 20 selectfont
        5 3 moveto (9) show
  } def
  /french_l {
        /Helvetica 20 selectfont
        5 3 moveto (x) show
  } def
  /french_m {
  } def
  /french_n {
  } def
  /french_o {
  } def

  % french bourdons
  /bourdon_4 {
    frenchpen penend copy pop
    15 20 moveto
    15 2 penlineto
    11 20 moveto
    9 10 7 9 5 8 pencurveto
    19 8 penlineto
  } def
  /bourdon_5 {
    frenchpen penend copy pop
    17 20 moveto
    10 20 penlineto
    8 14 penlineto
    20 18 16 4 6 2 pencurveto
  } def
  /bourdon_6 {
    frenchpen penend copy pop
    18 20 moveto
    16 20 penlineto
    8 20 7 6 11 2 pencurveto
    9 9 moveto
    14 13 penlineto
    17 11 17 6 13 4 pencurveto
  } def
  /bourdon_7 {
    frenchpen penend copy pop
    6 20 moveto
    17 20 penlineto
    8 2 penlineto
    9 10 moveto
    15 10 penlineto
  } def

  % italian bourdons
  /bourdon_8 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    12 19 moveto
    -2 15 28 5 12 1 curveto
    -4 5 26 15 12 19 curveto
    stroke
  } def
  /bourdon_9 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    14 19 moveto
    2 18 9 2 16 14 curveto
    14 19 moveto
    17 18 18 10 8 0 curveto
    stroke
  } def
  /bourdon_10 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    4 14 moveto
    5 20 7 18 9 15 curveto
    17 1 lineto
    7 1 moveto
    17 18 lineto
    stroke
  } def
  /bourdon_11 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    6 19 moveto
    6 9 6 9 15 9 curveto
    16 19 moveto
    16 4 12 5 8 1 curveto
    stroke
  } def
  /bourdon_12 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    5 18 moveto 5 1 lineto
    3 1 moveto 9 1 lineto
    10 10 moveto
    9 15 10 19 15 19 curveto
    20 19 20 9 12 1 curveto
    20 1 lineto
    stroke
  } def
  /bourdon_13 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    5 18 moveto 5 1 lineto
    3 1 moveto 9 1 lineto
    10 10 moveto
    8 15 10 19 14 19 curveto
    20 19 17 11 14 9 curveto
    21 9 21 1 13 1 curveto
    stroke
  } def
  /bourdon_14 {
    1.5 setlinewidth 1 setlinecap 1 setlinejoin
    5 18 moveto 5 1 lineto
    3 1 moveto 9 1 lineto
    12 19 moveto
    12 16 11 8 9 6 curveto 19 6 lineto
    17 19 moveto 17 1 lineto
    stroke
  } def

  /test_t {   % test output
  } def
end

% enable new font
/BuildChar {
20 0
0 0 20 20
setcachedevice
/char exch def
0.1 setlinewidth
begin
  Encoding char get
  drawchar exch get
  exec
  end
}def

end

/ItalianTabfont itabfont definefont pop
%%EndResource
%----------------------------------------------------------------
